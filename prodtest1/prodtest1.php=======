<?php
/**
 * Plugin Name: prodtest1
 * Plugin URI: http://woocommerce.com/products/woocommerce-extension/
 * Description: Your extension's description text.
 * Version: 1.0.0
 * Author: Cedcoss
 * Author URI: http://localhost.com/
 * Developer: cedcoss team
 * Developer URI: http://localhost.com/
 * Text Domain: woocommerce-extension
 * Domain Path: /languages
 *
 * Woo: 12345:342928dfsfhsf8429842374wdf4234sfd
 * WC requires at least: 2.2
 * WC tested up to: 2.3
 *
 * Copyright: Â© 2009-2015 WooCommerce.
 * License: GNU General Public License v3.0
 * License URI: http://www.gnu.org/licenses/gpl-3.0.html
 */


function register_custom_product_page() {
    add_menu_page('custom products', 'custom products', 'add_users', 'custompage', '_custom_product_page', 12); 
}
add_action('admin_menu', 'register_custom_product_page');

function _custom_product_page() {
$args = array(
        'post_type'      => 'product',
        'posts_per_page' => 10,
        //'product_cat'    => 'hoodies'
    );

    $loop = new WP_Query( $args );

?>
    <div class="form_design">
    <h2>Product details</h2>
        <form method="post">
            <div>
               <label for="prods">All products:</label>
               <select name="prods" id="prods">
<?php
while ( $loop->have_posts() ) : $loop->the_post();
        global $product;
?>
                <option value="<?php echo get_the_ID(); ?>"><?php echo get_the_title() ?><option>
<?php
endwhile;
wp_reset_query();
?>
               </select>
            </div>
            <div>
<?php
// Get 10 most recent order ids in date descending order.
$query = new WC_Order_Query( array(
    'limit' => 10,
    'orderby' => 'date',
    'order' => 'DESC',
    'return' => 'ids',
) );
$orders = $query->get_orders();
foreach($orders as $order_id) {
$order = wc_get_order( $order_id );

?>
            <label for="orders">Orders:</label>
               <select name="orders" id="orders">

                <option value="<?php echo $order->get_id(); ?>"><?php echo $order->get_order_number(); ?><option>
<?php
}
?>
               </select>
           </div>
           <input type="hidden" name="first_name" value="<?php echo $order->get_billing_first_name(); ?>">
            <input type="hidden" name="last_name" value="<?php echo $order->get_billing_last_name(); ?>">
            <input type="hidden" name="company" value="<?php echo $order->get_billing_company(); ?>">
            <input type="hidden" name="email" value="<?php echo $order->get_billing_email(); ?>">
            <input type="hidden" name="phone" value="<?php echo $order->get_billing_phone(); ?>">
            <input type="hidden" name="address_1" value="<?php echo $order->get_billing_address_1(); ?>">
            <input type="hidden" name="address_2" value="<?php echo $order->get_billing_address_2(); ?>">
            <input type="hidden" name="city" value="<?php echo $order->get_billing_city(); ?>">
            <input type="hidden" name="state" value="<?php echo $order->get_billing_state(); ?>">
            <input type="hidden" name="country" value="<?php echo $order->get_billing_country(); ?>">
            <input type="hidden" name="postcode" value="<?php echo $order->get_shipping_postcode(); ?>">
           <input type="submit" name="createord" name="createord" value="create order">
        </form>
    </div>
<?php  
}

if(isset($_POST['createord'])) {
  echo '<script>alert();</script>';
 global $woocommerce;
$prodid = $_POST['prods'];
  $address = array(
      'first_name' => $_POST['first_name'],
      'last_name'  => $_POST['last_name'],
      'company'    => $_POST['company'],
      'email'      => $_POST['email'],
      'phone'      => $_POST['phone'],
      'address_1'  => $_POST['address_1'],
      'address_2'  => $_POST['address_2'],
      'city'       => $_POST['city'],
      'state'      => $_POST['state'],
      'postcode'   => $_POST['postcode'],
      'country'    => $_POST['country']
  );

  // Now we create the order
  $order = wc_create_order();

  // The add_product() function below is located in /plugins/woocommerce/includes/abstracts/abstract_wc_order.php
  $order->add_product( get_product($prodid), 1); // This is an existing SIMPLE product
  $order->set_address( $address, 'billing' );
  //
  $order->calculate_totals();
  $order->update_status("Completed", 'Imported order', TRUE);  

}

